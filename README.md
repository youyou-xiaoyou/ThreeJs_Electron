# 基于三维空间的结构化柜体内，求最短路径的算法实现

## 一、软件架构

**Node.js v16.20.1.**

**Electron: V25.3.1**

**three.js-r154**（直接本地导入了整个库，占用空间较大）



## 二、安装要求

上传的zip文件中AAA路径下有通过Electron打包的可执行文件，双击即可运行。

\out\threejs_electron-win32-x64\threejs_electron.exe



源代码请查看project文件夹，运行源码需要打开view.html文件并使用Visual Studio Code安装插件Liver Server启动静态服务器，在浏览器输入对应地址即可打开。



## 三、测试

**由于技术缘故，最终没能实现完全通过界面进行对配电柜的添加，起点和终点的设置，因此如果需要改动配电柜尺寸、起点和终点的坐标，需要到文件createRect.html中修改。**

但是如果仅进行对项目完成度的测试，可以直接通过上述方法打开view.html文件，直接点击模型测试按钮即可转跳到模型界面



## 四、测试用例

测试模型使用的配电柜参数为长800mm，宽600mm，高2200mm，框架横截面为50*50mm的矩形，起点坐标(250,400,825)，终点坐标(250,400,1625)



## 五、说明

### 1.整体思路

作为工业软件优先的考虑一定是安全可靠，因此对于这个寻路算法而言，不应该为了路径数值上绝对的短而把路径做的很复杂，弯弯绕绕，这种路径在实际中几乎无法安装，而且配电柜时高压设备，过度复杂的线路在维护过程中极易发生危险，这在工业中是绝对禁止的。因此在大部分时候一条一条安装是最安全，也是最符合人类思维的，所以路径搜索采用一条一条完成相比一次性同时进行搜索更加合适。另外，规定一个具体的弯折角度不仅有助于大幅减小算法时间复杂度，也更容易在工业上实现批量加工。

### 2.自定义输入配电柜尺寸

配电柜模型使用多个小长方体拼接而成，每个小长方体采用八个坐标定义，输入顺序如下图：

![image-20230730105021466](.\image\image-20230730105021466.png)



### 3.AStar算法说明

1）因为钣金一次只能向一个方向上弯折，所以必然必然存在于同一个平面上，因此可以将其投影到这个平面上，在这个平面使用AStar算法求最短路，如果向另一个方向弯折，只需要将其拆分为两部分单独考虑。

2）采用12方位进行路径搜索，其中上下左右时固定的，另外8个方位根据用户输入的safeAngle来确定，每次从集合中取出点，遍历这12个方向并计算与原方向的夹角，如果不符合则舍去。优点：与360全范围寻找相比，只规定12个方向数量级会小很多，且规定的方向由使用者决定，拥有一定的自由度，同时规定一个具体的弯折角度也更加容易在工业中实现规模化加工

<img src=".\image\image-20230730110053567.png" alt="image-20230730110053567" style="zoom:50%;" />

3）安全距离通过加粗障碍物的外边框实现，如果安全距离为1cm，则所有障碍物外边框加粗1cm，保证算法的通用性。

4）在实际环境中给定的途径点在连接的时候顺序都是提前确定了的，一般都是从上到下，从左到右，一次只会是一个方向，否则不便于工人安装且路径过于复杂会更容易诱发危险事故。因此在输入途径点的时候便确定通过顺序，可以将整条路径分割成若干段，对每段求解最优路径，这样整体得到的依然是相对最优解。

5）多条路径情况下采用逐个计算，每生成一条路径就将其作为障碍物添加到模型中。
